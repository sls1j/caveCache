<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>

<head>
	<title>openWYSIWYG | Insert or Modify Image</title>

	<script type="text/javascript" src="../scripts/wysiwyg-popup.js"></script>
	<script language="JavaScript" type="text/javascript">

		/* ---------------------------------------------------------------------- *\
		  Function    : insertImage()
		  Description : Inserts image into the WYSIWYG.
		\* ---------------------------------------------------------------------- */
		function insertImage() {
			var n = WYSIWYG_Popup.getParam('wysiwyg');

			// get values from form fields
			var src = document.getElementById('src').value;
			var alt = document.getElementById('alt').value;
			var width = document.getElementById('width').value
			var height = document.getElementById('height').value
			var border = document.getElementById('border').value
			var align = document.getElementById('align').value
			var vspace = document.getElementById('vspace').value
			var hspace = document.getElementById('hspace').value

			// insert image
			WYSIWYG.insertImage(src, width, height, align, border, alt, hspace, vspace, n);
			window.close();
		}

		/* ---------------------------------------------------------------------- *\
		  Function    : loadImage()
		  Description : load the settings of a selected image into the form fields
		\* ---------------------------------------------------------------------- */
		function loadImage() {
			var n = WYSIWYG_Popup.getParam('wysiwyg');

			// get selection and range
			var sel = WYSIWYG.getSelection(n);
			var range = WYSIWYG.getRange(sel);

			// the current tag of range
			var img = WYSIWYG.findParent("img", range);

			// if no image is defined then return
			if (img == null) return;

			// assign the values to the form elements
			for (var i = 0; i < img.attributes.length; i++) {
				var attr = img.attributes[i].name.toLowerCase();
				var value = img.attributes[i].value;
				//alert(attr + " = " + value);
				if (attr && value && value != "null") {
					switch (attr) {
						case "src":
							// strip off urls on IE
							if (WYSIWYG_Core.isMSIE) value = WYSIWYG.stripURLPath(n, value, false);
							document.getElementById('src').value = value;
							break;
						case "alt":
							document.getElementById('alt').value = value;
							break;
						case "align":
							selectItemByValue(document.getElementById('align'), value);
							break;
						case "border":
							document.getElementById('border').value = value;
							break;
						case "hspace":
							document.getElementById('hspace').value = value;
							break;
						case "vspace":
							document.getElementById('vspace').value = value;
							break;
						case "width":
							document.getElementById('width').value = value;
							break;
						case "height":
							document.getElementById('height').value = value;
							break;
					}
				}
			}

			// get width and height from style attribute in none IE browsers
			if (!WYSIWYG_Core.isMSIE && document.getElementById('width').value == "" && document.getElementById('width').value == "") {
				document.getElementById('width').value = img.style.width.replace(/px/, "");
				document.getElementById('height').value = img.style.height.replace(/px/, "");
			}
		}

		/* ---------------------------------------------------------------------- *\
		  Function    : selectItem()
		  Description : Select an item of an select box element by value.
		\* ---------------------------------------------------------------------- */
		function selectItemByValue(element, value) {
			if (element.options.length) {
				for (var i = 0; i < element.options.length; i++) {
					if (element.options[i].value == value) {
						element.options[i].selected = true;
					}
				}
			}
		}

	</script>
</head>

<style>
	.label {
		font-family: arial, verdana, helvetica;
		font-size: 13px;
		font-weight: bold;
	}

	.insert table {
		width: 380px;
		padding: 5px;
	}

	.insert td {
		padding-bottom: 2px;
		padding-top: 0px;
		font-family: arial, verdana, helvetica;
		font-size: 11px;
	}

	.insert input {
		font-size: 10px;
		width: 100%;
	}

	.layout {
		width: 380px;
		padding: 5px;
	}

	.layout td {
		padding-bottom: 2px;
		padding-top: 0px;
		font-family: arial, verdana, helvetica;
		font-size: 11px;
	}

	.layout input {
		font-size: 10px;
		width: 75px;
	}

	.layout-column {
		width: 180px;
	}

	.button-box {
		padding-top: 5px;
	}

	.button {
		float: right;
		padding: 2px;
		padding-left: 12px;
		padding-right: 12px;
		display: block;
	}

	.upload button{
		width: 100px;
	}
</style>

<body onLoad="loadImage();">
	<div class="label">Upload Image:</div>
	<table class="upload">
		<tr>
			<td width="80"><button>Upload Image</button></td>
		</tr>
	</table>
	<div class="label">Insert Image:</div>
	<table class="insert">
		<tr>
			<td width="80">Image URL:</td>
			<td width="300">
				<input type="text" name="src" id="src" value="">
			</td>
		</tr>
		<tr>
			<td>Alternate Text:</td>
			<td>
				<input type="text" name="alt" id="alt" value="">
			</td>
		</tr>
	</table>

	<div class="label">Layout:</div>
	<table class="layout">
		<tr>
			<td>
				<table class="layout-column">
					<tr>
						<td>Width:</td>
						<td>
							<input type="text" name="width" id="width" value="">
						</td>
					</tr>
					<tr>
						<td>Height:</td>
						<td>
							<input type="text" name="height" id="height" value="">
						</td>
					</tr>
					<tr>
						<td>Border:</td>
						<td>
							<input type="text" name="border" id="border" value="0">
						</td>
					</tr>
				</table>

			</td>
			<td>
				<table class="layout-column">
					<tr>
						<td>Alignment:</td>
						<td>
							<select name="align" id="align">
								<option value="">Not Set</option>
								<option value="left">Left</option>
								<option value="right">Right</option>
								<option value="texttop">Texttop</option>
								<option value="absmiddle">Absmiddle</option>
								<option value="baseline">Baseline</option>
								<option value="absbottom">Absbottom</option>
								<option value="bottom">Bottom</option>
								<option value="middle">Middle</option>
								<option value="top">Top</option>
							</select>
						</td>
					</tr>
					<tr>
						<td>Horizontal Space:</td>
						<td>
							<input type="text" name="hspace" id="hspace" value="">
						</td>
					</tr>
					<tr>
						<td>Vertical Space:</td>
						<td>
							<input type="text" name="vspace" id="vspace" value="">
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<div class="button-box" align="right">
		<input class="button" type="submit" value="Submit" onClick="insertImage();">
		<input class="button" type="submit" value="Cancel" onClick="window.close();">
	</div>
</body>

</html>